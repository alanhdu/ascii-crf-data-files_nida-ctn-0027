head(val)
nrow(val)
ggplot(data = val)+
geom_plot(mapping=aes(x=X, y=Y))+
labs(title="Task 3")
ggplot(data = val)+
geom_point(mapping=aes(x=X, y=Y))+
labs(title="Task 3")
?qnorm()
qnorm(0.95)
list.files()
getwd(
)
setwd("C:/Users/xiaoxue/Desktop/projects/ascii-crf-data-files_nida-ctn-0027/csv")
list.files
list.files()
knitr::opts_chunk$set(echo = TRUE)
tests<-read.csv("T_FRUDSAB.csv")
View(tests)
colnames(tests)
test<-tests[,c("patdeid","VISIT", "UDS011")]
View(test)
table(test$patdeid)
reg.data<-data.frame()
View(reg.data)
reg.data$patdeid<-unique(test$patdeid)
?data.frame()
reg.data<-data.frame(unique(test$patdeid))
View(reg.data)
reg.data$week1<-test[test$VISIT=="WK1", "UDS011"]
nrow(reg.data)
reg.data$week1<-rep(NA, nrow(reg.data))
reg.data$week1<-rep(NA, nrow(reg.data))
reg.data$week1<-rep(NA, nrow(reg.data))
reg.data$week2<-rep(NA, nrow(reg.data))
reg.data$week3<-rep(NA, nrow(reg.data))
reg.data$week4<-rep(NA, nrow(reg.data))
reg.data$week21<-rep(NA, nrow(reg.data))
reg.data$week22<-rep(NA, nrow(reg.data))
reg.data$week23<-rep(NA, nrow(reg.data))
reg.data$week24<-rep(NA, nrow(reg.data))
i<-1
reg.data$week1[i]<-test[test$patdeid==i&test$VISIT=="WK1", "UDS011"]
reg.data$week2[i]<-test[test$patdeid==i&test$VISIT=="WK2", "UDS011"]
reg.data$week3[i]<-test[test$patdeid==i&test$VISIT=="WK3", "UDS011"]
reg.data$week4[i]<-test[test$patdeid==i&test$VISIT=="WK4", "UDS011"]
reg.data$week21[i]<-test[test$patdeid==i&test$VISIT=="WK21", "UDS011"]
reg.data$week22[i]<-test[test$patdeid==i&test$VISIT=="WK22", "UDS011"]
reg.data$week23[i]<-test[test$patdeid==i&test$VISIT=="WK23", "UDS011"]
reg.data$week24[i]<-test[test$patdeid==i&test$VISIT=="WK24", "UDS011"]
i<-4
reg.data$week1[i]<-test[test$patdeid==i&test$VISIT=="WK1", "UDS011"]
reg.data$week2[i]<-test[test$patdeid==i&test$VISIT=="WK2", "UDS011"]
reg.data$week3[i]<-test[test$patdeid==i&test$VISIT=="WK3", "UDS011"]
reg.data$week4[i]<-test[test$patdeid==i&test$VISIT=="WK4", "UDS011"]
reg.data$week21[i]<-test[test$patdeid==i&test$VISIT=="WK21", "UDS011"]
reg.data$week22[i]<-test[test$patdeid==i&test$VISIT=="WK22", "UDS011"]
reg.data$week23[i]<-test[test$patdeid==i&test$VISIT=="WK23", "UDS011"]
reg.data$week24[i]<-test[test$patdeid==i&test$VISIT=="WK24", "UDS011"]
for(i in 1: nrow(reg.data)){
reg.data$week1[i]<-test[test$patdeid==i&test$VISIT=="WK1", "UDS011"]
reg.data$week2[i]<-test[test$patdeid==i&test$VISIT=="WK2", "UDS011"]
reg.data$week3[i]<-test[test$patdeid==i&test$VISIT=="WK3", "UDS011"]
reg.data$week4[i]<-test[test$patdeid==i&test$VISIT=="WK4", "UDS011"]
reg.data$week21[i]<-test[test$patdeid==i&test$VISIT=="WK21", "UDS011"]
reg.data$week22[i]<-test[test$patdeid==i&test$VISIT=="WK22", "UDS011"]
reg.data$week23[i]<-test[test$patdeid==i&test$VISIT=="WK23", "UDS011"]
reg.data$week24[i]<-test[test$patdeid==i&test$VISIT=="WK24", "UDS011"]
}
i<-1
While(i<=nrow(reg.data)){
While(i<=nrow(reg.data)){
i<-6
reg.data$week1[i]<-test[test$patdeid==i&test$VISIT=="WK1", "UDS011"]
reg.data$week2[i]<-test[test$patdeid==i&test$VISIT=="WK2", "UDS011"]
reg.data$week3[i]<-test[test$patdeid==i&test$VISIT=="WK3", "UDS011"]
reg.data$week3[i]<-ifelse(test[test$patdeid==i&test$VISIT=="WK3","UDS011"],
test[test$patdeid==i&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week3[i]<-ifelse(test[test$patdeid==i&test$VISIT=="WK3","UDS011"]!=NULL,
test[test$patdeid==i&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week3[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK3", "UDS011"], NA)
i<-1
reg.data$week1[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week3[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week4[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK4","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK4", "UDS011"], NA)
reg.data$week5[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK5","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK5", "UDS011"], NA)
reg.data$week6[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK6","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK6", "UDS011"], NA)
reg.data$week7[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK7","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK7", "UDS011"], NA)
reg.data$week8[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK8","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK8", "UDS011"], NA)
reg.data<-data.frame(unique(test$patdeid))
reg.data$week1<-rep(NA, nrow(reg.data))
reg.data$week2<-rep(NA, nrow(reg.data))
reg.data$week3<-rep(NA, nrow(reg.data))
reg.data$week4<-rep(NA, nrow(reg.data))
reg.data$week21<-rep(NA, nrow(reg.data))
reg.data$week22<-rep(NA, nrow(reg.data))
reg.data$week23<-rep(NA, nrow(reg.data))
reg.data$week24<-rep(NA, nrow(reg.data))
i<-1
reg.data$week1[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week3[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week4[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK4","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK4", "UDS011"], NA)
reg.data$week21[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK21","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK21", "UDS011"], NA)
reg.data$week22[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK22","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK22", "UDS011"], NA)
reg.data$week23[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK23","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK23", "UDS011"], NA)
reg.data$week24[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK24","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK24", "UDS011"], NA)
nrow(reg.data)
for(i in 1:nrow(reg.data)){
reg.data$week1[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week3[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week4[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK4","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK4", "UDS011"], NA)
reg.data$week21[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK21","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK21", "UDS011"], NA)
reg.data$week22[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK22","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK22", "UDS011"], NA)
reg.data$week23[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK23","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK23", "UDS011"], NA)
reg.data$week24[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK24","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK24", "UDS011"], NA)
}
write.csv(reg.data, "regression_data")
sapply(reg.data, function(x) sum(is.na(x)))
reg.data$lab<-rep(NA.nrow(reg.data))
reg.data$lab<-rep(NA, nrow(reg.data))
i<-1
reg.data$lab[i]<ifelse(reg.data[i,c("week21","week22","week23","week24")]==0, 0, 1)
reg.data$lab[i]<-ifelse(reg.data[i,c("week21","week22","week23","week24")]==0, 0, 1)
reg.data$lab[i]<-ifelse(reg.data[i,c("week21","week22","week23","week24")]==0, 0, 1)
reg.data[i,c("week21","week22","week23","week24")
]
class(reg.data[i,c("week21","week22","week23","week24"))
class(reg.data[i,c("week21","week22","week23","week24")])
i<-1
reg.data$lab[i]<-ifelse(sum(is.na(reg.data[i,c(6:9)]))==0, 0, 1)
i<-5
reg.data$lab[i]<-ifelse(sum(reg.data[i,c(6:9)])==0, 0, 1)
i<-5
reg.data$lab[i]<-ifelse(sum(reg.data[i,c(6:9)])==0, 0, 1)
i<-1
reg.data$lab[i]<-ifelse(sum(reg.data[i,c(6:9)])==0, 0, 1)
reg.data$lab[i]<-ifelse(sum(reg.data[i,c(6:9)])==0, 0, 1)
i<-2
reg.data$lab[i]<-ifelse(sum(reg.data[i,c(6:9)])==0, 0, 1)
i<-3
reg.data$lab[i]<-ifelse(sum(reg.data[i,c(6:9)])==0, 0, 1)
i<-4
reg.data$lab[i]<-ifelse(sum(reg.data[i,c(6:9)])==0, 0, 1)
reg.data$lab[i]<-ifelse(sum(reg.data[i,c(6:9)],na.rm = FALSE)==0, 0, 1)
i<-4
if(sum(is.na(reg.data[i,6:9])){
if(sum(is.na(reg.data[i,6:9]))){
reg.data$lab[i]<-1
}
else{
if(sum(is.na(reg.data[i,6:9]))){
reg.data$lab[i]<-1
}
else{
i<-4
ifelse(sum(is.na(reg.data[i,6:9])), 1,
ifelse(sum(data[i,c(6:9)])!=0,1,0))
reg.data$lab<-ifelse(sum(is.na(reg.data[i,6:9])), 1,
ifelse(sum(data[i,c(6:9)])!=0,1,0))
reg.data$lab[i]<-ifelse(sum(is.na(reg.data[i,6:9])), 1,
ifelse(sum(data[i,c(6:9)])!=0,1,0))
i<-1
reg.data$lab[i]<-ifelse(sum(is.na(reg.data[i,6:9])), 1,
ifelse(sum(data[i,c(6:9)])!=0,1,0))
reg.data$lab[i]<-ifelse(sum(is.na(reg.data[i,6:9])), 1,
ifelse(sum(data[i,6:9])!=0,1,0))
reg.data$lab[i]<-ifelse(sum(is.na(reg.data[i,6:9])), 1,
ifelse(sum(reg.data[i,6:9])!=0,1,0))
i<-2
reg.data$lab[i]<-ifelse(sum(is.na(reg.data[i,6:9])), 1,
ifelse(sum(reg.data[i,6:9])!=0,1,0))
for(i in 1:nrow(reg.data)){
reg.data$lab[i]<-ifelse(sum(is.na(reg.data[i,6:9])), 1,
ifelse(sum(reg.data[i,6:9])!=0,1,0))
}
table(reg.data$lab)
sapply(reg.data, function(x) sum(is.na(x)))
data<-na.omit(reg.data)
knitr::opts_chunk$set(echo = TRUE)
data <- reg.data[sum(reg.data[2:5])!=0,]
View(data)
data <- reg.data[sum(reg.data[,2:5])!=0,]
data <- reg.data[sum(is,na(reg.data[,2:5]))<4,]
data <- reg.data[sum(is.na(reg.data[,2:5]))<4,]
is.na(reg.data[,2:5])
data <- reg.data[-(is.na(reg.data$week1)&is.na(reg.data$week2)&
is.na(reg.data$week3)&is.na(reg.data$week4)),]
data <- reg.data[-which(apply(reg.data[,2:5],1,function(x)all(is.na(x)))),]
data$group<-sample(c(1,1,1,2))
data$group<-sample(c(1,1,1,2), replace = TRUE)
data$group<-sample(c(1,1,1,2), n=nrow(data), replace = TRUE)
data$group<-sample(c(1,1,1,2), size=nrow(data), replace = TRUE)
train <- data[data$group==1,]
test <- data[data$group==2,]
View(train)
model <- glm(lab~week1+week2+week3+week4,family=binomial(link='logit'),data=train)
summary(model)
View(data)
list.files()
ran<-read.csv("T_FRRAN.csv")
View(ran)
reg.data<-data.frame(ran$patdeid)
tests1<-tests[,c("patdeid","VISIT", "UDS011")]
View(tests1)
reg.data$week1<-rep(NA, nrow(reg.data))
reg.data$week2<-rep(NA, nrow(reg.data))
reg.data$week3<-rep(NA, nrow(reg.data))
reg.data$week4<-rep(NA, nrow(reg.data))
reg.data$week21<-rep(NA, nrow(reg.data))
reg.data$week22<-rep(NA, nrow(reg.data))
reg.data$week23<-rep(NA, nrow(reg.data))
reg.data$week24<-rep(NA, nrow(reg.data))
for(i in 1:nrow(reg.data)){
reg.data$week1[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week3[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week4[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK4","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK4", "UDS011"], NA)
reg.data$week21[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK21","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK21", "UDS011"], NA)
reg.data$week22[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK22","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK22", "UDS011"], NA)
reg.data$week23[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK23","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK23", "UDS011"], NA)
reg.data$week24[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK24","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK24", "UDS011"], NA)
}
test<-tests[,c("patdeid","VISIT", "UDS011")]
for(i in 1:nrow(reg.data)){
reg.data$week1[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week3[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week4[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK4","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK4", "UDS011"], NA)
reg.data$week21[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK21","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK21", "UDS011"], NA)
reg.data$week22[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK22","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK22", "UDS011"], NA)
reg.data$week23[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK23","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK23", "UDS011"], NA)
reg.data$week24[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK24","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK24", "UDS011"], NA)
}
missmap(reg.data, main = "Missing values vs observed")
Amelia
library(Amelia)
missmap(reg.data, main = "Missing values vs observed")
tests<-read.csv("RANDOM.csv")
reg.data<-data.frame(ran$patdeid)
View(reg.data)
tests<-read.csv("T_FRUDSAB.csv")
test<-tests[,c("patdeid","VISIT", "UDS011")]
View(test)
id<-read.csv("RANDOM.csv")
View(id)
reg.data<-data.frame(id$patdeid)
reg.data$week1<-rep(NA, nrow(reg.data))
reg.data$week2<-rep(NA, nrow(reg.data))
reg.data$week3<-rep(NA, nrow(reg.data))
reg.data$week4<-rep(NA, nrow(reg.data))
reg.data$week21<-rep(NA, nrow(reg.data))
reg.data$week22<-rep(NA, nrow(reg.data))
reg.data$week23<-rep(NA, nrow(reg.data))
reg.data$week24<-rep(NA, nrow(reg.data))
for(i in 1:nrow(reg.data)){
reg.data$week1[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week3[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week4[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK4","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK4", "UDS011"], NA)
reg.data$week21[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK21","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK21", "UDS011"], NA)
reg.data$week22[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK22","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK22", "UDS011"], NA)
reg.data$week23[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK23","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK23", "UDS011"], NA)
reg.data$week24[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK24","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK24", "UDS011"], NA)
}
View(tests)
View(test)
reg.data$week1[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week2[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week2[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK2","UDS011"]),
test[test$patdeid==i&test$VISIT=="WK2", "UDS011"], NA)
i<-8
reg.data$week1[i]<-ifelse(length(test[test$patdeid==i&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK1", "UDS011"], NA)
i<-7
reg.data$week1[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week3[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week4[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK4","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK4", "UDS011"], NA)
reg.data$week21[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK21","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK21", "UDS011"], NA)
reg.data$week22[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK22","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK22", "UDS011"], NA)
reg.data$week23[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK23","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK23", "UDS011"], NA)
reg.data$week24[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK24","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK24", "UDS011"], NA)
i<-6
reg.data$week1[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week3[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week4[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK4","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK4", "UDS011"], NA)
reg.data$week21[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK21","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK21", "UDS011"], NA)
reg.data$week22[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK22","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK22", "UDS011"], NA)
reg.data$week23[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK23","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK23", "UDS011"], NA)
reg.data$week24[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK24","UDS011"])!=0,
test[test$patdeid==i&test$VISIT=="WK24", "UDS011"], NA)
i<-6
reg.data$week1[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week3[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week4[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK4","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK4", "UDS011"], NA)
reg.data$week21[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK21","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK21", "UDS011"], NA)
reg.data$week22[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK22","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK22", "UDS011"], NA)
reg.data$week23[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK23","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK23", "UDS011"], NA)
reg.data$week24[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK24","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK24", "UDS011"], NA)
i<-7
reg.data$week1[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week3[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week4[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK4","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK4", "UDS011"], NA)
reg.data$week21[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK21","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK21", "UDS011"], NA)
reg.data$week22[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK22","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK22", "UDS011"], NA)
reg.data$week23[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK23","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK23", "UDS011"], NA)
reg.data$week24[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK24","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK24", "UDS011"], NA)
for(i in 1:nrow(reg.data)){
reg.data$week1[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK1","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK1", "UDS011"], NA)
reg.data$week2[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK2","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK2", "UDS011"], NA)
reg.data$week3[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK3","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK3", "UDS011"], NA)
reg.data$week4[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK4","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK4", "UDS011"], NA)
reg.data$week21[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK21","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK21", "UDS011"], NA)
reg.data$week22[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK22","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK22", "UDS011"], NA)
reg.data$week23[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK23","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK23", "UDS011"], NA)
reg.data$week24[i]<-ifelse(
length(test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK24","UDS011"])!=0,
test[test$patdeid==reg.data$id.patdeid[i]&test$VISIT=="WK24", "UDS011"], NA)
}
missmap(reg.data, main = "Missing values vs observed")
sapply(reg.data, function(x) sum(is.na(x)))
data <- reg.data[-which(apply(reg.data[,2:5],1,function(x)all(is.na(x)))),]
sapply(data, function(x) sum(is.na(x)))
View(data)
data$lab<-rep(NA, nrow(data))
data$lab[i]<-ifelse(sum(is.na(data[i,6:9])), 1,
ifelse(sum(data[i,6:9])!=0,1,0))
for(i in 1:nrow(data)){
data$lab[i]<-ifelse(sum(is.na(data[i,6:9])), 1,
ifelse(sum(data[i,6:9])!=0,1,0))
}
table(data$lab)
missmap(data, main = "Missing values vs observed")
data$group<-sample(c(1,1,1,2), size=nrow(data), replace = TRUE)
train <- data[data$group==1,]
test <- data[data$group==2,]
model <- glm(lab~week1+week2+week3+week4,family=binomial(link='logit'),data=train)
summary(model)
ROCRpred <- prediction(predict, train$lab)
library(ROCR)
predict <- predict(model, newdata=train, type = 'response')
ROCRpred <- prediction(predict, train$lab)
ROCRperf <- performance(ROCRpred, 'tpr','fpr')
plot(ROCRperf, colorize = TRUE, text.adj = c(-0.2,1.7))
tpredict<-predict(model, newdata=test, type = 'response')
tROCRpred <- prediction(tpredict, test$lab)
tROCRperf <- performance(tROCRpred, 'tpr','fpr')
plot(tROCRperf, colorize = TRUE, text.adj = c(-0.2,1.7))
sapply(data, function(x) sum(is.na(x)))
ctrl <- trainControl(method = "cv", number = 10, savePredictions = T)
library(caret)
ctrl <- trainControl(method = "cv", number = 10, savePredictions = T)
data$lab<-as.factor(data$lab)
glm_fit <- train(lab~week1+week2+week3+week4,
data = data,
method = "glm",
family=binomial(link='logit'),
trControl = ctrl,
na.omit=T)
?na.action
glm_fit <- train(lab~week1+week2+week3+week4,
data = data,
method = "glm",
family=binomial(link='logit'),
trControl = ctrl,
na.action(na.omit(data[,2:5])))
?train
glm_fit <- train(lab~week1+week2+week3+week4,
data = data,
method = "glm",
family=binomial(link='logit'),
trControl = ctrl,
na.action='na.omit')
glm_fit
glm_fit$finalModel
head(glm_fit$pred)
